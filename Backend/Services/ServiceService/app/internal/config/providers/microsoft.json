{
  "name": "microsoft",
  "logo_url": "https://cdn-icons.flaticon.com/svg/6424/6424314.svg?token=exp=1768584532~hmac=fb17d5e9de071402c67be628d0107488",
  "oauth2": {
    "client_id": "MICROSOFT_CLIENT_ID",
    "client_secret": "MICROSOFT_CLIENT_SECRET",
    "auth_url": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
    "token_url": "https://login.microsoftonline.com/common/oauth2/v2.0/token",
    "redirect_uri": "http://localhost:8083/oauth2/callback",
    "scopes": [
      "openid",
      "email",
      "profile",
      "offline_access",
      "User.Read",
      "Mail.Read",
      "Mail.Send",
      "Calendars.ReadWrite",
      "Files.ReadWrite",
      "Tasks.ReadWrite",
      "ChannelMessage.Send"
    ],
    "user_info_url": "https://graph.microsoft.com/v1.0/me",
    "refresh": { "enabled": true }
  },
  "mappings": [
    { "field_key": "provider_user_id", "json_path": "id", "type": "string" },
    { "field_key": "display_name", "json_path": "displayName", "type": "string" },

    { "field_key": "email", "json_path": "userPrincipalName", "type": "string" },
    { "field_key": "email_raw", "json_path": "mail", "type": "string" },

    { "field_key": "given_name", "json_path": "givenName", "type": "string" },
    { "field_key": "family_name", "json_path": "surname", "type": "string" },

    { "field_key": "avatar_url", "json_path": "userPrincipalName", "type": "string" }
  ]
}
