{
  "provider": "microsoft",
  "name": "microsoft_teams",
  "label": "Microsoft Teams",
  "icon_url": "",
  "logo_url": "https://cdn-icons.flaticon.com/svg/14644/14644998.svg?token=exp=1768583294~hmac=718751fbe56014a8f5047c7fe5ab28ca",
  "actions": [
    {
      "title": "teams_new_message",
      "label": "Teams - New Message Posted",
      "type": "webhook",
      "fields": [
        { "name": "team_id", "type": "text", "label": "Team ID", "required": true, "default": "" },
        { "name": "channel_id", "type": "text", "label": "Channel ID", "required": true, "default": "" }
      ],
      "output_fields": [
        { "name": "author", "type": "text", "label": "Author" },
        { "name": "message", "type": "text", "label": "Message" }
      ]
    }
  ],
  "reactions": [
    {
      "title": "teams_post_message",
      "label": "Teams - Post a Message",
      "url": "https://graph.microsoft.com/v1.0/teams/{{team_id}}/channels/{{channel_id}}/messages",
      "method": "POST",
      "bodyType": "json",
      "fields": [
        { "name": "team_id", "type": "text", "label": "Team ID", "required": true, "default": "" },
        { "name": "channel_id", "type": "text", "label": "Channel ID", "required": true, "default": "" },
        { "name": "message", "type": "textarea", "label": "Message (HTML allowed)", "required": true, "default": "" }
      ],
      "body_struct": [
        { "path": "body.contentType", "type": "text", "value": "html" },
        { "path": "body.content", "type": "text", "value": "{{message}}" }
      ]
    }
  ]
}
