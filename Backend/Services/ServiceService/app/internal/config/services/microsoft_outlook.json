{
  "provider": "microsoft",
  "name": "microsoft_outlook",
  "label": "Outlook",
  "icon_url": "",
  "logo_url": "https://cdn-icons.flaticon.com/svg/9768/9768517.svg?token=exp=1768583417~hmac=8ba9285f9eb3d1b482a977ee37363431",
  "actions": [
    {
      "title": "outlook_new_email",
      "label": "Outlook - New Email Received",
      "type": "webhook",
      "fields": [
        { "name": "from_contains", "type": "text", "label": "From contains (optional)", "required": false, "default": "" },
        { "name": "subject_contains", "type": "text", "label": "Subject contains (optional)", "required": false, "default": "" }
      ],
      "output_fields": [
        { "name": "id", "type": "text", "label": "Message ID" },
        { "name": "subject", "type": "text", "label": "Subject" },
        { "name": "from", "type": "text", "label": "From" },
        { "name": "body", "type": "text", "label": "Body" },
        { "name": "receivedDateTime", "type": "text", "label": "Received at" }
      ]
    }
  ],
  "reactions": [
    {
      "title": "outlook_send_email",
      "label": "Outlook - Send an Email",
      "url": "https://graph.microsoft.com/v1.0/me/sendMail",
      "method": "POST",
      "bodyType": "json",
      "fields": [
        { "name": "to", "type": "text", "label": "To", "required": true, "default": "" },
        { "name": "subject", "type": "text", "label": "Subject", "required": true, "default": "" },
        { "name": "message", "type": "textarea", "label": "Message", "required": true, "default": "" },
        {
          "name": "content_type",
          "type": "text",
          "label": "Content type",
          "required": false,
          "default": "Text",
          "selection": [
            { "value": "Text", "label": "Text" },
            { "value": "HTML", "label": "HTML" }
          ]
        }
      ],
      "body_struct": [
        { "path": "message.subject", "type": "text", "value": "{{subject}}" },
        { "path": "message.body.contentType", "type": "text", "value": "{{content_type}}" },
        { "path": "message.body.content", "type": "text", "value": "{{message}}" },
        {
          "path": "message.toRecipients",
          "type": "array",
          "value": [
            {
              "path": "",
              "type": "object",
              "value": [{ "path": "emailAddress.address", "type": "text", "value": "{{to}}" }]
            }
          ]
        },
        { "path": "saveToSentItems", "type": "boolean", "value": "true" }
      ]
    }
  ]
}
